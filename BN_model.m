function [Pro_IL6R, Pro_Jak1, Pro_Gluta, Pro_IL23R, Pro_Akt, Pro_cMyc, Pro_FasLR, Pro_IL6, Pro_Ulk12, Pro_IL2R, Pro_AMPK, Pro_Tbet, Pro_IL21, Pro_IL4R, Pro_IL18R, Pro_HPK1, Pro_STAT4, Pro_mTORC2, Pro_TGFbR, Pro_ACAD, Pro_Lip_syn, Pro_IL4, Pro_AICD1, Pro_BCl2, Pro_IFNg, Pro_STAT3, Pro_LXRs, Pro_STAT1, Pro_STAT6, Pro_CFLIP, Pro_NFkB, Pro_Cycle, Pro_SOCS1, Pro_Mem, Pro_IRAK, Pro_GATA3, Pro_IL17, Pro_AICD2, Pro_aatrans, Pro_IL12R, Pro_IFNgR, Pro_RORgt, Pro_IL2, Pro_aGly, Pro_SREBP2, Pro_NFAT, Pro_PI3K, Pro_p73, Pro_Foxp3, Pro_Auto, Pro_ERRa, Pro_Glu_uptake, Pro_Lip_eff, Pro_ROS, Pro_STAT5, Pro_mTORC1, Pro_Mito_ox, Pro_IL21R]=BN_model(C_IL18, C_Resist, C_mTORC1_t, C_IFNg, C_TGFb, C_IL27, C_IL4, C_AMP, C_CD28, C_TCR, C_IL6, C_Rib, C_IL12, C_IL23, C_IL2, Pro_IL6R, Pro_Jak1, Pro_Gluta, Pro_IL23R, Pro_Akt, Pro_cMyc, Pro_FasLR, Pro_IL6, Pro_Ulk12, Pro_IL2R, Pro_AMPK, Pro_Tbet, Pro_IL21, Pro_IL4R, Pro_IL18R, Pro_HPK1, Pro_STAT4, Pro_mTORC2, Pro_TGFbR, Pro_ACAD, Pro_Lip_syn, Pro_IL4, Pro_AICD1, Pro_BCl2, Pro_IFNg, Pro_STAT3, Pro_LXRs, Pro_STAT1, Pro_STAT6, Pro_CFLIP, Pro_NFkB, Pro_Cycle, Pro_SOCS1, Pro_Mem, Pro_IRAK, Pro_GATA3, Pro_IL17, Pro_AICD2, Pro_aatrans, Pro_IL12R, Pro_IFNgR, Pro_RORgt, Pro_IL2, Pro_aGly, Pro_SREBP2, Pro_NFAT, Pro_PI3K, Pro_p73, Pro_Foxp3, Pro_Auto, Pro_ERRa, Pro_Glu_uptake, Pro_Lip_eff, Pro_ROS, Pro_STAT5, Pro_mTORC1, Pro_Mito_ox, Pro_IL21R, iterate_run, iterate_record)
%This function takes the activity levels of the external nodes of the BN
%and the internal state of a CD4+ T cell as inputs, runs the Boolean 
%network defined herein, and calculates the activity levels of the 
%internal nodes accordingly.
    %Initialise the Boolean network according to the internal state of the
    %CD4+ T cell under consideration. The external nodes are not
    %initialised in this way.
    IL6R = (rand < Pro_IL6R);
    Jak1 = (rand < Pro_Jak1);
    Gluta = (rand < Pro_Gluta);
    IL23R = (rand < Pro_IL23R);
    Akt = (rand < Pro_Akt);
    cMyc = (rand < Pro_cMyc);
    FasLR = (rand < Pro_FasLR);
    IL6 = (rand < Pro_IL6);
    Ulk12 = (rand < Pro_Ulk12);
    IL2R = (rand < Pro_IL2R);
    AMPK = (rand < Pro_AMPK);
    Tbet = (rand < Pro_Tbet);
    IL21 = (rand < Pro_IL21);
    IL4R = (rand < Pro_IL4R);
    IL18R = (rand < Pro_IL18R);
    HPK1 = (rand < Pro_HPK1);
    STAT4 = (rand < Pro_STAT4);
    mTORC2 = (rand < Pro_mTORC2);
    TGFbR = (rand < Pro_TGFbR);
    ACAD =  (rand < Pro_ACAD);
    Lip_syn = (rand < Pro_Lip_syn);
    IL4 = (rand < Pro_IL4);
    AICD1 = (rand < Pro_AICD1);
    BCl2 = (rand < Pro_BCl2);
    IFNg = (rand < Pro_IFNg);
    STAT3 = (rand < Pro_STAT3);
    LXRs = (rand < Pro_LXRs);
    STAT1 = (rand < Pro_STAT1);
    STAT6 = (rand < Pro_STAT6);
    CFLIP = (rand < Pro_CFLIP);
    NFkB = (rand < Pro_NFkB);
    Cycle = (rand < Pro_Cycle);
    SOCS1 = (rand < Pro_SOCS1);
    Mem = (rand < Pro_Mem);
    IRAK = (rand < Pro_IRAK);
    GATA3 = (rand < Pro_GATA3);
    IL17 = (rand < Pro_IL17);
    AICD2 = (rand < Pro_AICD2);
    aatrans = (rand < Pro_aatrans);
    IL12R = (rand < Pro_IL12R);
    IFNgR = (rand < Pro_IFNgR);
    RORgt = (rand < Pro_RORgt);
    IL2 = (rand < Pro_IL2);
    aGly = (rand < Pro_aGly);
    SREBP2 = (rand < Pro_SREBP2);
    NFAT = (rand < Pro_NFAT);
    PI3K = (rand < Pro_PI3K);
    p73 = (rand < Pro_p73);
    Foxp3 = (rand < Pro_Foxp3);
    Auto = (rand < Pro_Auto);
    ERRa = (rand < Pro_ERRa);
    Glu_uptake = (rand < Pro_Glu_uptake);
    Lip_eff = (rand < Pro_Lip_eff);
    ROS = (rand < Pro_ROS); 
    STAT5 = (rand < Pro_STAT5);
    mTORC1 = (rand < Pro_mTORC1);
    Mito_ox = (rand < Pro_Mito_ox);
    IL21R = (rand < Pro_IL21R);
    %Update the Boolean network iterate_run times.
    for it=1:iterate_run
        %At the beginning of each iteration, determine the states of the
        %external nodes according to the inputs.
        IL18 = (rand < C_IL18);
        Resist = (rand < C_Resist);
        mTORC1_t = (rand < C_mTORC1_t);
        eIFNg = (rand < C_IFNg);
        TGFb = (rand < C_TGFb);
        IL27 = (rand < C_IL27);
        eIL4 = (rand < C_IL4);
        AMP = (rand < C_AMP);
        CD28 = (rand < C_CD28);
        TCR = (rand < C_TCR);
        eIL6 = (rand < C_IL6);
        Rib = (rand < C_Rib);
        IL12 = (rand < C_IL12);
        IL23 = (rand < C_IL23);
        eIL2 = (rand < C_IL2);
        %All the nodes are updated synchronously at the end of the
        %iteration, hence the extra variables for temporary storage.
        IL6R_temp = (IL6 | eIL6);
        Jak1_temp = (IFNgR & ~SOCS1);
        Gluta_temp = (cMyc);
        IL23R_temp = ((IL23 & STAT3 & ~Tbet) | (STAT3 & ~Tbet));
        Akt_temp = (PI3K & mTORC2);
        cMyc_temp = (TCR);
        FasLR_temp = ((eIL2 & IL4R & NFAT & TCR & ROS)|(eIL2 & NFAT & TCR & ROS));
        IL6_temp = (RORgt);
        Ulk12_temp = (AMPK & ~mTORC1);
        IL2R_temp = (IL2 & NFAT);
        AMPK_temp = ((AMP & ~Ulk12) | (mTORC1 & mTORC1_t & ~Ulk12));
        Tbet_temp = ((STAT1 & ~Foxp3 & ~RORgt) | (STAT4 & ~Foxp3 & ~RORgt) | (Tbet & ~IFNg & ~IL12 & ~Foxp3 & ~RORgt));
        IL21_temp = (STAT3 & NFAT);
        IL4R_temp = ((IL4 & ~SOCS1) | (eIL4 & ~SOCS1));
        IL18R_temp = (IL18 & IL12 & ~STAT6);
        HPK1_temp = (TCR & Resist);
        STAT4_temp = (IL12R & IL12 & ~GATA3);
        mTORC2_temp = (Rib & PI3K);
        TGFbR_temp = (TGFb & NFAT);
        ACAD_temp =  (~BCl2);
        Lip_syn_temp = (SREBP2 & ~AMPK);
        IL4_temp = (GATA3 & NFAT & ~STAT1);
        AICD1_temp = (FasLR & p73  & STAT1 & ~CFLIP);
        BCl2_temp = (Akt & ~ROS);
        IFNg_temp = ((NFkB & ~STAT3 & ~STAT6) | (STAT4 & NFkB & NFAT & ~STAT3 & ~STAT6) | (Tbet & ~STAT3 & ~STAT6));
        STAT3_temp = (IL21R | IL6R | IL23R);
        LXRs_temp = (~TCR);
        STAT1_temp = (Jak1 | (IL27 & NFAT));
        STAT6_temp = (IL4R  & ~SOCS1  & ~IFNg);
        CFLIP_temp = (~(eIL2 & NFAT & ~Resist) & ~(eIL2 & IL4R & NFAT & ~Resist));
        NFkB_temp = (IRAK & ~Foxp3);
        Cycle_temp = (cMyc);
        SOCS1_temp = (Tbet | STAT1);
        Mem_temp = (BCl2);
        IRAK_temp = (IL18R);
        GATA3_temp = ((GATA3 & ~Foxp3 & ~RORgt & ~Tbet & ~TGFb) | (STAT5 & ~Foxp3 & ~RORgt & ~Tbet & ~TGFb) | (STAT6 & NFAT & ~Foxp3 & ~RORgt & ~Tbet & ~TGFb));
        IL17_temp = ((RORgt & ~STAT1 & ~STAT5) | (STAT3 & IL23R & IL17 & ~STAT1 & ~STAT5));
        AICD2_temp = (p73 & ~BCl2);
        aatrans_temp = (Akt);
        IL12R_temp = ((IL12 & NFAT & ~GATA3) | (STAT4 & ~GATA3) | (Tbet & ~GATA3) | (TCR & ~GATA3));
        IFNgR_temp = ((IFNg & NFAT) | (eIFNg & NFAT));
        RORgt_temp = (TGFbR & ((IL21R & STAT3) | (IL6R & STAT3)) & ~Foxp3 & ~GATA3 & ~Tbet);
        IL2_temp = (NFAT & NFkB & ~Tbet);
        aGly_temp = (mTORC1 & Akt & cMyc);
        SREBP2_temp = (TCR & mTORC1);
        NFAT_temp = (TCR & ~Foxp3);
        PI3K_temp = ((CD28 & TCR) | (eIL2 & NFAT) | (eIL2 & IL4R & NFAT));
        p73_temp = (~HPK1);
        Foxp3_temp = ((STAT5 & ~GATA3 & ~IL21R & ~ (IL6R & STAT3)) | (TGFbR & ~GATA3 & ~IL21R & ~ (IL6R & STAT3)));
        Auto_temp = (Ulk12);
        ERRa_temp = (TCR);
        Glu_uptake_temp = (ERRa & Akt);
        Lip_eff_temp = (LXRs);
        ROS_temp = (TCR & ~HPK1);
        STAT5_temp = (IL2R);
        mTORC1_temp = (Akt & ~AMPK & ~Ulk12);
        Mito_ox_temp = (ERRa);
        IL21R_temp = (IL21);
        %Synchronously update the nodes at the end of the iteration.
        IL6R=IL6R_temp;
        Jak1=Jak1_temp;
        Gluta=Gluta_temp;
        IL23R=IL23R_temp;
        Akt=Akt_temp;
        cMyc=cMyc_temp;
        FasLR=FasLR_temp;
        IL6=IL6_temp;
        Ulk12=Ulk12_temp;
        IL2R=IL2R_temp;
        AMPK=AMPK_temp;
        Tbet=Tbet_temp;
        IL21=IL21_temp;
        IL4R=IL4R_temp;
        IL18R=IL18R_temp;
        HPK1=HPK1_temp;
        STAT4=STAT4_temp;
        mTORC2=mTORC2_temp;
        TGFbR=TGFbR_temp;
        ACAD=ACAD_temp;
        Lip_syn=Lip_syn_temp;
        IL4=IL4_temp;
        AICD1=AICD1_temp;
        BCl2=BCl2_temp;
        IFNg=IFNg_temp;
        STAT3=STAT3_temp;
        LXRs=LXRs_temp;
        STAT1=STAT1_temp;
        STAT6=STAT6_temp;
        CFLIP=CFLIP_temp;
        NFkB=NFkB_temp;
        Cycle=Cycle_temp;
        SOCS1=SOCS1_temp;
        Mem=Mem_temp;
        IRAK=IRAK_temp;
        GATA3=GATA3_temp;
        IL17=IL17_temp;
        AICD2=AICD2_temp;
        aatrans=aatrans_temp;
        IL12R=IL12R_temp;
        IFNgR=IFNgR_temp;
        RORgt=RORgt_temp;
        IL2=IL2_temp;
        aGly=aGly_temp;
        SREBP2=SREBP2_temp;
        NFAT=NFAT_temp;
        PI3K=PI3K_temp;
        p73=p73_temp;
        Foxp3=Foxp3_temp;
        Auto=Auto_temp;
        ERRa=ERRa_temp;
        Glu_uptake=Glu_uptake_temp;
        Lip_eff=Lip_eff_temp;
        ROS=ROS_temp;
        STAT5=STAT5_temp;
        mTORC1=mTORC1_temp;
        Mito_ox=Mito_ox_temp;
        IL21R=IL21R_temp;
    end
    %Update the Boolean network another iterate_record times. For each
    %node, calculate the proportion of iterations where it is on.
    IL6R_sum=0;
    Jak1_sum=0;
    Gluta_sum=0;
    IL23R_sum=0;
    Akt_sum=0;
    cMyc_sum=0;
    FasLR_sum=0;
    IL6_sum=0;
    Ulk12_sum=0;
    IL2R_sum=0;
    AMPK_sum=0;
    Tbet_sum=0;
    IL21_sum=0;
    IL4R_sum=0;
    IL18R_sum=0;
    HPK1_sum=0;
    STAT4_sum=0;
    mTORC2_sum=0;
    TGFbR_sum=0;
    ACAD_sum=0;
    Lip_syn_sum=0;
    IL4_sum=0;
    AICD1_sum=0;
    BCl2_sum=0;
    IFNg_sum=0;
    STAT3_sum=0;
    LXRs_sum=0;
    STAT1_sum=0;
    STAT6_sum=0;
    CFLIP_sum=0;
    NFkB_sum=0;
    Cycle_sum=0;
    SOCS1_sum=0;
    Mem_sum=0;
    IRAK_sum=0;
    GATA3_sum=0;
    IL17_sum=0;
    AICD2_sum=0;
    aatrans_sum=0;
    IL12R_sum=0;
    IFNgR_sum=0;
    RORgt_sum=0;
    IL2_sum=0;
    aGly_sum=0;
    SREBP2_sum=0;
    NFAT_sum=0;
    PI3K_sum=0;
    p73_sum=0;
    Foxp3_sum=0;
    Auto_sum=0;
    ERRa_sum=0;
    Glu_uptake_sum=0;
    Lip_eff_sum=0;
    ROS_sum=0;
    STAT5_sum=0;
    mTORC1_sum=0;
    Mito_ox_sum=0;
    IL21R_sum=0;
    for it=1:iterate_record
        %At the beginning of each iteration, determine the states of the
        %external nodes according to the inputs.
        IL18 = (rand < C_IL18);
        Resist = (rand < C_Resist);
        mTORC1_t = (rand < C_mTORC1_t);
        eIFNg = (rand < C_IFNg);
        TGFb = (rand < C_TGFb);
        IL27 = (rand < C_IL27);
        eIL4 = (rand < C_IL4);
        AMP = (rand < C_AMP);
        CD28 = (rand < C_CD28);
        TCR = (rand < C_TCR);
        eIL6 = (rand < C_IL6);
        Rib = (rand < C_Rib);
        IL12 = (rand < C_IL12);
        IL23 = (rand < C_IL23);
        eIL2 = (rand < C_IL2);
        %All the nodes are updated synchronously at the end of the
        %iteration, hence the extra variables for temporary storage.
        %iteration, hence the extra variables for temporary storage.
        IL6R_temp = (IL6 | eIL6);
        Jak1_temp = (IFNgR & ~SOCS1);
        Gluta_temp = (cMyc);
        IL23R_temp = ((IL23 & STAT3 & ~Tbet) | (STAT3 & ~Tbet));
        Akt_temp = (PI3K & mTORC2);
        cMyc_temp = (TCR);
        FasLR_temp = ((eIL2 & IL4R & NFAT & TCR & ROS)|(eIL2 & NFAT & TCR & ROS));
        IL6_temp = (RORgt);
        Ulk12_temp = (AMPK & ~mTORC1);
        IL2R_temp = (IL2 & NFAT);
        AMPK_temp = ((AMP & ~Ulk12) | (mTORC1 & mTORC1_t & ~Ulk12));
        Tbet_temp = ((STAT1 & ~Foxp3 & ~RORgt) | (STAT4 & ~Foxp3 & ~RORgt) | (Tbet & ~IFNg & ~IL12 & ~Foxp3 & ~RORgt));
        IL21_temp = (STAT3 & NFAT);
        IL4R_temp = ((IL4 & ~SOCS1) | (eIL4 & ~SOCS1));
        IL18R_temp = (IL18 & IL12 & ~STAT6);
        HPK1_temp = (TCR & Resist);
        STAT4_temp = (IL12R & IL12 & ~GATA3);
        mTORC2_temp = (Rib & PI3K);
        TGFbR_temp = (TGFb & NFAT);
        ACAD_temp =  (~BCl2);
        Lip_syn_temp = (SREBP2 & ~AMPK);
        IL4_temp = (GATA3 & NFAT & ~STAT1);
        AICD1_temp = (FasLR & p73  & STAT1 & ~CFLIP);
        BCl2_temp = (Akt & ~ROS);
        IFNg_temp = ((NFkB & ~STAT3 & ~STAT6) | (STAT4 & NFkB & NFAT & ~STAT3 & ~STAT6) | (Tbet & ~STAT3 & ~STAT6));
        STAT3_temp = (IL21R | IL6R | IL23R);
        LXRs_temp = (~TCR);
        STAT1_temp = (Jak1 | (IL27 & NFAT));
        STAT6_temp = (IL4R  & ~SOCS1  & ~IFNg);
        CFLIP_temp = (~(eIL2 & NFAT & ~Resist) & ~(eIL2 & IL4R & NFAT & ~Resist));
        NFkB_temp = (IRAK & ~Foxp3);
        Cycle_temp = (cMyc);
        SOCS1_temp = (Tbet | STAT1);
        Mem_temp = (BCl2);
        IRAK_temp = (IL18R);
        GATA3_temp = ((GATA3 & ~Foxp3 & ~RORgt & ~Tbet & ~TGFb) | (STAT5 & ~Foxp3 & ~RORgt & ~Tbet & ~TGFb) | (STAT6 & NFAT & ~Foxp3 & ~RORgt & ~Tbet & ~TGFb));
        IL17_temp = ((RORgt & ~STAT1 & ~STAT5) | (STAT3 & IL23R & IL17 & ~STAT1 & ~STAT5));
        AICD2_temp = (p73 & ~BCl2);
        aatrans_temp = (Akt);
        IL12R_temp = ((IL12 & NFAT & ~GATA3) | (STAT4 & ~GATA3) | (Tbet & ~GATA3) | (TCR & ~GATA3));
        IFNgR_temp = ((IFNg & NFAT) | (eIFNg & NFAT));
        RORgt_temp = (TGFbR & ((IL21R & STAT3) | (IL6R & STAT3)) & ~Foxp3 & ~GATA3 & ~Tbet);
        IL2_temp = (NFAT & NFkB & ~Tbet);
        aGly_temp = (mTORC1 & Akt & cMyc);
        SREBP2_temp = (TCR & mTORC1);
        NFAT_temp = (TCR & ~Foxp3);
        PI3K_temp = ((CD28 & TCR) | (eIL2 & NFAT) | (eIL2 & IL4R & NFAT));
        p73_temp = (~HPK1);
        Foxp3_temp = ((STAT5 & ~GATA3 & ~IL21R & ~ (IL6R & STAT3)) | (TGFbR & ~GATA3 & ~IL21R & ~ (IL6R & STAT3)));
        Auto_temp = (Ulk12);
        ERRa_temp = (TCR);
        Glu_uptake_temp = (ERRa & Akt);
        Lip_eff_temp = (LXRs);
        ROS_temp = (TCR & ~HPK1);
        STAT5_temp = (IL2R);
        mTORC1_temp = (Akt & ~AMPK & ~Ulk12);
        Mito_ox_temp = (ERRa);
        IL21R_temp = (IL21);
        %Record the state of each node at the end of the iteration.
        IL6R_sum=IL6R_sum+IL6R_temp;
        Jak1_sum=Jak1_sum+Jak1_temp;
        Gluta_sum=Gluta_sum+Gluta_temp;
        IL23R_sum=IL23R_sum+IL23R_temp;
        Akt_sum=Akt_sum+Akt_temp;
        cMyc_sum=cMyc_sum+cMyc_temp;
        FasLR_sum=FasLR_sum+FasLR_temp;
        IL6_sum=IL6_sum+IL6_temp;
        Ulk12_sum=Ulk12_sum+Ulk12_temp;
        IL2R_sum=IL2R_sum+IL2R_temp;
        AMPK_sum=AMPK_sum+AMPK_temp;
        Tbet_sum=Tbet_sum+Tbet_temp;
        IL21_sum=IL21_sum+IL21_temp;
        IL4R_sum=IL4R_sum+IL4R_temp;
        IL18R_sum=IL18R_sum+IL18R_temp;
        HPK1_sum=HPK1_sum+HPK1_temp;
        STAT4_sum=STAT4_sum+STAT4_temp;
        mTORC2_sum=mTORC2_sum+mTORC2_temp;
        TGFbR_sum=TGFbR_sum+TGFbR_temp;
        ACAD_sum=ACAD_sum+ACAD_temp;
        Lip_syn_sum=Lip_syn_sum+Lip_syn_temp;
        IL4_sum=IL4_sum+IL4_temp;
        AICD1_sum=AICD1_sum+AICD1_temp;
        BCl2_sum=BCl2_sum+BCl2_temp;
        IFNg_sum=IFNg_sum+IFNg_temp;
        STAT3_sum=STAT3_sum+STAT3_temp;
        LXRs_sum=LXRs_sum+LXRs_temp;
        STAT1_sum=STAT1_sum+STAT1_temp;
        STAT6_sum=STAT6_sum+STAT6_temp;
        CFLIP_sum=CFLIP_sum+CFLIP_temp;
        NFkB_sum=NFkB_sum+NFkB_temp;
        Cycle_sum=Cycle_sum+Cycle_temp;
        SOCS1_sum=SOCS1_sum+SOCS1_temp;
        Mem_sum=Mem_sum+Mem_temp;
        IRAK_sum=IRAK_sum+IRAK_temp;
        GATA3_sum=GATA3_sum+GATA3_temp;
        IL17_sum=IL17_sum+IL17_temp;
        AICD2_sum=AICD2_sum+AICD2_temp;
        aatrans_sum=aatrans_sum+aatrans_temp;
        IL12R_sum=IL12R_sum+IL12R_temp;
        IFNgR_sum=IFNgR_sum+IFNgR_temp;
        RORgt_sum=RORgt_sum+RORgt_temp;
        IL2_sum=IL2_sum+IL2_temp;
        aGly_sum=aGly_sum+aGly_temp;
        SREBP2_sum=SREBP2_sum+SREBP2_temp;
        NFAT_sum=NFAT_sum+NFAT_temp;
        PI3K_sum=PI3K_sum+PI3K_temp;
        p73_sum=p73_sum+p73_temp;
        Foxp3_sum=Foxp3_sum+Foxp3_temp;
        Auto_sum=Auto_sum+Auto_temp;
        ERRa_sum=ERRa_sum+ERRa_temp;
        Glu_uptake_sum=Glu_uptake_sum+Glu_uptake_temp;
        Lip_eff_sum=Lip_eff_sum+Lip_eff_temp;
        ROS_sum=ROS_sum+ROS_temp;
        STAT5_sum=STAT5_sum+STAT5_temp;
        mTORC1_sum=mTORC1_sum+mTORC1_temp;
        Mito_ox_sum=Mito_ox_sum+Mito_ox_temp;
        IL21R_sum=IL21R_sum+IL21R_temp;
        %Synchronously update the nodes at the end of the iteration.        
        IL6R=IL6R_temp;
        Jak1=Jak1_temp;
        Gluta=Gluta_temp;
        IL23R=IL23R_temp;
        Akt=Akt_temp;
        cMyc=cMyc_temp;
        FasLR=FasLR_temp;
        IL6=IL6_temp;
        Ulk12=Ulk12_temp;
        IL2R=IL2R_temp;
        AMPK=AMPK_temp;
        Tbet=Tbet_temp;
        IL21=IL21_temp;
        IL4R=IL4R_temp;
        IL18R=IL18R_temp;
        HPK1=HPK1_temp;
        STAT4=STAT4_temp;
        mTORC2=mTORC2_temp;
        TGFbR=TGFbR_temp;
        ACAD=ACAD_temp;
        Lip_syn=Lip_syn_temp;
        IL4=IL4_temp;
        AICD1=AICD1_temp;
        BCl2=BCl2_temp;
        IFNg=IFNg_temp;
        STAT3=STAT3_temp;
        LXRs=LXRs_temp;
        STAT1=STAT1_temp;
        STAT6=STAT6_temp;
        CFLIP=CFLIP_temp;
        NFkB=NFkB_temp;
        Cycle=Cycle_temp;
        SOCS1=SOCS1_temp;
        Mem=Mem_temp;
        IRAK=IRAK_temp;
        GATA3=GATA3_temp;
        IL17=IL17_temp;
        AICD2=AICD2_temp;
        aatrans=aatrans_temp;
        IL12R=IL12R_temp;
        IFNgR=IFNgR_temp;
        RORgt=RORgt_temp;
        IL2=IL2_temp;
        aGly=aGly_temp;
        SREBP2=SREBP2_temp;
        NFAT=NFAT_temp;
        PI3K=PI3K_temp;
        p73=p73_temp;
        Foxp3=Foxp3_temp;
        Auto=Auto_temp;
        ERRa=ERRa_temp;
        Glu_uptake=Glu_uptake_temp;
        Lip_eff=Lip_eff_temp;
        ROS=ROS_temp;
        STAT5=STAT5_temp;
        mTORC1=mTORC1_temp;
        Mito_ox=Mito_ox_temp;
        IL21R=IL21R_temp;
    end
    %Calculate the proportions.
    Pro_IL6R=IL6R_sum/iterate_record;
    Pro_Jak1=Jak1_sum/iterate_record;
    Pro_Gluta=Gluta_sum/iterate_record;
    Pro_IL23R=IL23R_sum/iterate_record;
    Pro_Akt=Akt_sum/iterate_record;
    Pro_cMyc=cMyc_sum/iterate_record;
    Pro_FasLR=FasLR_sum/iterate_record;
    Pro_IL6=IL6_sum/iterate_record;
    Pro_Ulk12=Ulk12_sum/iterate_record;
    Pro_IL2R=IL2R_sum/iterate_record;
    Pro_AMPK=AMPK_sum/iterate_record;
    Pro_Tbet=Tbet_sum/iterate_record;
    Pro_IL21=IL21_sum/iterate_record;
    Pro_IL4R=IL4R_sum/iterate_record;
    Pro_IL18R=IL18R_sum/iterate_record;
    Pro_HPK1=HPK1_sum/iterate_record;
    Pro_STAT4=STAT4_sum/iterate_record;
    Pro_mTORC2=mTORC2_sum/iterate_record;
    Pro_TGFbR=TGFbR_sum/iterate_record;
    Pro_ACAD=ACAD_sum/iterate_record;
    Pro_Lip_syn=Lip_syn_sum/iterate_record;
    Pro_IL4=IL4_sum/iterate_record;
    Pro_AICD1=AICD1_sum/iterate_record;
    Pro_BCl2=BCl2_sum/iterate_record;
    Pro_IFNg=IFNg_sum/iterate_record;
    Pro_STAT3=STAT3_sum/iterate_record;
    Pro_LXRs=LXRs_sum/iterate_record;
    Pro_STAT1=STAT1_sum/iterate_record;
    Pro_STAT6=STAT6_sum/iterate_record;
    Pro_CFLIP=CFLIP_sum/iterate_record;
    Pro_NFkB=NFkB_sum/iterate_record;
    Pro_Cycle=Cycle_sum/iterate_record;
    Pro_SOCS1=SOCS1_sum/iterate_record;
    Pro_Mem=Mem_sum/iterate_record;
    Pro_IRAK=IRAK_sum/iterate_record;
    Pro_GATA3=GATA3_sum/iterate_record;
    Pro_IL17=IL17_sum/iterate_record;
    Pro_AICD2=AICD2_sum/iterate_record;
    Pro_aatrans=aatrans_sum/iterate_record;
    Pro_IL12R=IL12R_sum/iterate_record;
    Pro_IFNgR=IFNgR_sum/iterate_record;
    Pro_RORgt=RORgt_sum/iterate_record;
    Pro_IL2=IL2_sum/iterate_record;
    Pro_aGly=aGly_sum/iterate_record;
    Pro_SREBP2=SREBP2_sum/iterate_record;
    Pro_NFAT=NFAT_sum/iterate_record;
    Pro_PI3K=PI3K_sum/iterate_record;
    Pro_p73=p73_sum/iterate_record;
    Pro_Foxp3=Foxp3_sum/iterate_record;
    Pro_Auto=Auto_sum/iterate_record;
    Pro_ERRa=ERRa_sum/iterate_record;
    Pro_Glu_uptake=Glu_uptake_sum/iterate_record;
    Pro_Lip_eff=Lip_eff_sum/iterate_record;
    Pro_ROS=ROS_sum/iterate_record;
    Pro_STAT5=STAT5_sum/iterate_record;
    Pro_mTORC1=mTORC1_sum/iterate_record;
    Pro_Mito_ox=Mito_ox_sum/iterate_record;
    Pro_IL21R=IL21R_sum/iterate_record;
end